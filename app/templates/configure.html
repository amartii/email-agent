{% extends "base.html" %}
{% block title %}Email Agent — Configurar campaña{% endblock %}
{% block step2_active %}active{% endblock %}

{% block content %}
<div class="oto-wizard-header">
    <h1 class="oto-page-title">Configurar campaña</h1>
    <p class="oto-page-subtitle">Define las credenciales de envío y personaliza el contenido de los correos.</p>
</div>

<form id="configForm">
<div class="row g-4">

    <!-- Left column -->
    <div class="col-lg-6">
        <div class="card mb-4">
            <div class="card-header"><i class="bi bi-shield-lock me-2"></i>Cuenta de envío</div>
            <div class="card-body p-4">
                <div class="mb-3">
                    <label class="form-label">Nombre de la campaña</label>
                    <input type="text" name="campaign_name" class="form-control" placeholder="Ej: Prospección Q1 2025" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Gmail</label>
                    <input type="email" name="sender_email" class="form-control" placeholder="tu@gmail.com" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">App Password <a href="https://myaccount.google.com/apppasswords" target="_blank" class="text-decoration-none small" style="color:var(--oto-accent)">¿Cómo obtenerla?</a></label>
                    <input type="password" name="app_password" class="form-control" placeholder="xxxx xxxx xxxx xxxx" required>
                    <div class="form-text">Contraseña de aplicación de 16 caracteres generada en tu cuenta Google.</div>
                </div>
                <div class="mb-3">
                    <label class="form-label">Follow-up (días sin respuesta)</label>
                    <input type="number" name="followup_days" class="form-control" value="3" min="1" max="30">
                </div>
                <button type="button" class="btn btn-oto-outline w-100" id="btnTestCreds">
                    <i class="bi bi-plug me-2"></i>Probar conexión
                </button>
            </div>
        </div>
    </div>

    <!-- Right column -->
    <div class="col-lg-6">
        <div class="card mb-4">
            <div class="card-header">
                <i class="bi bi-envelope me-2"></i>Email principal
                <span class="float-end" id="variablesHint" style="font-weight:400;color:var(--oto-muted);font-size:0.78rem;"></span>
            </div>
            <div class="card-body p-4">
                <div class="mb-3">
                    <label class="form-label">Asunto</label>
                    <input type="text" name="subject" class="form-control" placeholder="Hola {{Nombre}}, te escribo sobre..." required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Cuerpo (HTML)</label>
                    <textarea name="body_html" class="form-control font-monospace" rows="5"
                        placeholder="<p>Hola <strong>{{Nombre}}</strong>,</p>&#10;<p>Me pongo en contacto...</p>" required></textarea>
                </div>
                <div class="mb-0">
                    <label class="form-label">Cuerpo (texto plano)</label>
                    <textarea name="body_text" class="form-control" rows="3"
                        placeholder="Hola {{Nombre}}, me pongo en contacto..." required></textarea>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header"><i class="bi bi-arrow-repeat me-2"></i>Follow-up</div>
            <div class="card-body p-4">
                <div class="mb-3">
                    <label class="form-label">Asunto follow-up</label>
                    <input type="text" name="followup_subject" class="form-control" placeholder="Seguimiento — {{Nombre}}">
                </div>
                <div class="mb-3">
                    <label class="form-label">Cuerpo follow-up (HTML)</label>
                    <textarea name="followup_body_html" class="form-control" rows="3"
                        placeholder="<p>Hola {{Nombre}}, ¿recibiste mi correo anterior?</p>"></textarea>
                </div>
                <div class="mb-0">
                    <label class="form-label">Cuerpo follow-up (texto plano)</label>
                    <textarea name="followup_body_text" class="form-control" rows="2"
                        placeholder="Hola {{Nombre}}, seguimiento del correo anterior."></textarea>
                </div>
            </div>
        </div>
    </div>

</div>

<div class="mt-4">
    <button type="submit" class="btn btn-oto-primary px-5">
        <i class="bi bi-send me-2"></i>Guardar y lanzar campaña
    </button>
    <a href="/" class="btn btn-oto-outline ms-2">
        <i class="bi bi-arrow-left me-1"></i>Atrás
    </a>
</div>
</form>
{% endblock %}
